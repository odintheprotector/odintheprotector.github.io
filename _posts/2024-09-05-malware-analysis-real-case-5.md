---
layout: post
title: Malware Analysis - Real Case 5
description: A type of Vidar stealer  
tags: [Malware, Real Case, Blue Team, Reverse Engineering, Vidar, Stealer, Forensic]
---

Hi everyone, welcome to the next chapter of my RE series. Today I want to share a real case about Vidar stealer which had amazing techniques and tactics. Want to know it right now? 
Take a seat, make a coffee and enjoy my article. Let's go

Sample: click [here](https://bazaar.abuse.ch/download/c1a96310dd45b906c51fd21fd604550225e1eec1941245850b24773e22768ad7/) to see it.

### Analysing
First, always check sample information:

![image](https://github.com/user-attachments/assets/dac95d1f-65f8-4d51-965d-7ded5985f0f9)

It's PE32 executable and it's **Mono/.Net**, from here we can use [dnSpy](https://github.com/dnSpy/dnSpy) to decompile it:

![image](https://github.com/user-attachments/assets/f0b63317-2004-41b0-abf6-dadcb9a89abb)

Yay it worked, and now it's time for analysing. But yeah, it's not easy as I thought...:

![image](https://github.com/user-attachments/assets/f44f503b-f4bc-4742-9e98-214dc917905b)

Almost all variables and function names were encrypted also the source code length was too big so it's very hard to analyse it by hand. But we cannot stop here, if we cannot 
apply static analysing, let's use dynamic analysing which is running the file to see its behaviours. I used **any.run** to run it and I got a good result: 

![image](https://github.com/user-attachments/assets/5f6383dc-2622-49df-9672-965706b1971e)

- The file will run **MSBuild.exe** process.
- After run, a **cmd.exe** process will be established and it will run a command to self-delete, also run **timeout.exe** to delay execution: <br>
  ![image](https://github.com/user-attachments/assets/4ae744e8-a219-45c2-9a40-66579451833a)

  ![image](https://github.com/user-attachments/assets/e0de519a-fcaa-4b0b-9a89-916e4369dc9f)
- While running that command, it will steal browser information: <br>
  ![image](https://github.com/user-attachments/assets/8986f5e2-f4a7-4af4-ae18-f1dc1d8b2d0f)

- A C2 server was established when the file was run: <br>
  ![image](https://github.com/user-attachments/assets/1c3399e3-8689-4135-968b-014e14504330)

  ![image](https://github.com/user-attachments/assets/d9143765-2673-4b1e-a86e-e6d77403f2d0)

When I saw it, I was sure that all information that was stolen would be sent to **Telegram**, and also there's a connection to **Steam**, it made me remember a technique is called **DDR**, 
a Vidar malware was used this technique before (you can check [here](https://darktrace.com/blog/vidar-info-stealer-malware-distributed-via-malvertising-on-google))

### IOCs
- URL: hxxps[://]23[.]199[.]218[.]33 (Steam)
- URL: hxxps[://]188[.]245[.]87[.]202 (Another C2 server was established)
- URL: hxxps[://]149[.]154[.]167[.]99 (Telegram)

### Conclusion
This type of malware is dangerous, especially the use of obfucation of malware payloads can make detection and analysis more challenging. It's 
very important that don't click or download any weird links or files, always update your computer to ensure that your firewall and all protection method inside will be updated! Last word, 
thank you very much for reading my article, as I've told you before, I'm just a newbie in Cyber Security and maybe my post can have mistakes so it's very grateful that you give me advices 
for a better article! Thank you again and see you in the next post in the future, bye!! 



  
